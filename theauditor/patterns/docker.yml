# Docker security and best practice patterns
patterns:
  - name: "docker-root-user"
    description: "Container running as root user - security risk"
    regex: "^(?!.*USER\\s+(?!root)\\w+).*FROM.*"
    languages: ["dockerfile"]
    severity: "high"
    
  - name: "docker-unpinned-base-image"
    description: "Unpinned base image tag - using :latest or no tag specified"
    regex: "^FROM\\s+[^:]+(:latest)?\\s*$|^FROM\\s+[^:]+\\s*$"
    languages: ["dockerfile"]
    severity: "medium"
    
  - name: "docker-hardcoded-secrets"
    description: "Potential secrets exposed in ARG or ENV instructions"
    regex: "(ARG|ENV)\\s+.*(SECRET|TOKEN|PASSWORD|KEY|API_KEY|PRIVATE|CREDENTIAL|AUTH)\\s*="
    languages: ["dockerfile"]
    severity: "critical"
