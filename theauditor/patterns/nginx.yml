# nginx configuration security patterns
patterns:
  - name: "nginx-missing-security-headers"
    description: "Missing critical security headers (CSP, HSTS)"
    regex: "^(?!.*add_header\\s+(Content-Security-Policy|Strict-Transport-Security)).*server\\s*\\{"
    languages: ["nginx", "conf"]
    severity: "high"
    
  - name: "nginx-weak-ssl-protocols"
    description: "Weak or outdated SSL/TLS protocols enabled"
    regex: "ssl_protocols\\s+.*(SSLv2|SSLv3|TLSv1(?!\\.2|\\.3)|TLSv1\\.0|TLSv1\\.1)"
    languages: ["nginx", "conf"]
    severity: "critical"
    
  - name: "nginx-server-tokens-enabled"
    description: "Server version disclosure enabled - information leak"
    regex: "server_tokens\\s+on\\s*;|^(?!.*server_tokens\\s+off).*http\\s*\\{"
    languages: ["nginx", "conf"]
    severity: "medium"
