# PostgreSQL Row-Level Security (RLS) patterns
patterns:
  - name: "postgres-policy-missing-using"
    description: "CREATE POLICY without USING clause - potential data leak"
    regex: "CREATE\\s+POLICY\\s+\\w+\\s+ON\\s+\\w+(?!.*\\bUSING\\b)"
    languages: ["sql", "postgresql"]
    severity: "critical"
    
  - name: "postgres-rls-no-policies"
    description: "Table has RLS enabled but no policies defined"
    regex: "ALTER\\s+TABLE\\s+(\\w+)\\s+ENABLE\\s+ROW\\s+LEVEL\\s+SECURITY(?!.*CREATE\\s+POLICY.*\\1)"
    languages: ["sql", "postgresql"]
    severity: "critical"
